<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Survival functions • NeuroblastomaPSM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Survival functions">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">NeuroblastomaPSM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Implementing_cure_threshold.html">Implementing Cure Threshold</a></li>
    <li><a class="dropdown-item" href="../articles/Processing_IPD.html">Processing IPD</a></li>
    <li><a class="dropdown-item" href="../articles/PSM.html">Partition Survival Model</a></li>
    <li><a class="dropdown-item" href="../articles/Survival_functions.html">Survival functions</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/W-Mohammed/NeuroblastomaPSM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Survival functions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/W-Mohammed/NeuroblastomaPSM/blob/main/vignettes/Survival_functions.Rmd" class="external-link"><code>vignettes/Survival_functions.Rmd</code></a></small>
      <div class="d-none name"><code>Survival_functions.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction:<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><strong>Survival Analysis</strong> is a statistical approach that
enables the examination of event occurrence rates over time without
assuming these rates remain constant. Principally, it facilitates
modeling the duration until an event’s occurrence, comparison of such
durations across diverse groups, or the investigation of the
relationship between time-to-event and quantitative variables. This
method is particularly adept at handling censored data, a scenario where
the event of interest (such as death, failure, or recovery) hasn’t
occurred for some subjects during the study period.</p>
<p><strong>Hazard Function</strong> represents the instant rate of event
occurrence at a given time point, <em>t</em>. Unlike the assumption of
constant hazard rates in some analyses, survival analysis recognizes the
variability of these rates over time. The cumulative hazard then
aggregates the hazard experienced until time <em>t</em>.</p>
<p><strong>Survival Function</strong> is defined as the likelihood of an
individual’s survival—or alternatively, the non-occurrence of the event
of interest—up to a certain point in time, <em>t</em>. Mathematically,
it’s depicted as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo>&gt;</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S(t) = Pr(T&gt;t)</annotation></semantics></math>,
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
representing a probability value between 0 and 1, given that survival
times are non-negative
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">T \geq 0</annotation></semantics></math>).</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo>&gt;</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> S(t) = Pr(T&gt;t) </annotation></semantics></math></p>
<p><strong>Kaplan-Meier Curve</strong> visualizes the survival function
as a step function, marking the cumulative probability of survival over
time. It remains horizontal during intervals without events, dropping at
points where events occur, reflecting changes in the survival
function.</p>
<p><strong>Censoring in Survival Analysis</strong> is a unique aspect
concerning missing data wherein the event of interest is not observed
for certain subjects by the study’s end, either due to their withdrawal
or other non-event-related reasons. The predominant form encountered is
right censoring, with left censoring occurring when the start time is
unknown.</p>
<p><strong>hazard ratio (HR)</strong> is the key metric derived from a
Cox regression analysis. This ratio quantifies the comparative hazards
between two distinct groups at any given moment. It reflects the instant
rate at which the event of interest occurs among those still susceptible
to it. Importantly, it should <strong>not</strong> be construed as a
measure of risk, although it is frequently misunderstood in this way.
For a regression coefficient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>,
the hazard ratio is computed as HR =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\exp(\beta)</annotation></semantics></math>.</p>
<p>An HR less than 1 suggests a lower hazard of the event under study,
typically death, for the group in question compared to the reference
group. Conversely, an HR greater than 1 indicates a higher hazard of the
event for the group in question. Thus, an HR of 0.59 would mean that the
hazard for females is 0.59 times that for males at any specific time
point, signifying that females have a markedly lower hazard of death
compared to males according to the dataset.</p>
<p><strong>Proportional Hazards Assumption</strong> is fundamental to
comparing survival functions across groups, such as different patient
cohorts, this assumption does not necessitate constant hazards but
maintains a constant hazard ratio over time, enabling comparisons of
hazard rates across different observation periods.</p>
</div>
<div class="section level2">
<h2 id="survival-objects">Survival objects:<a class="anchor" aria-label="anchor" href="#survival-objects"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IPD_data</span> <span class="op">&lt;-</span> <span class="fu">NeuroblastomaPSM</span><span class="fu">::</span><span class="va"><a href="../reference/IPD_data.html">IPD_data</a></span></span>
<span><span class="co"># Split IPD by curves and treatments: </span></span>
<span><span class="va">IPD_curves_trts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">IPD_data</span>,</span>
<span>  f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">IPD_data</span><span class="op">$</span><span class="va">trt</span>, <span class="va">IPD_data</span><span class="op">$</span><span class="va">curve</span><span class="op">)</span> </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IPD_curves_trts</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`names&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IPD_curves_trts</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">surv_data_nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\."</span>, <span class="st">" "</span>, <span class="va">surv_data_nm</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">surv_data</span> <span class="op">&lt;-</span> <span class="va">IPD_curves_trts</span><span class="op">[[</span><span class="va">surv_data_nm</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">surv_data</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">surv_data</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Dinutuximab β EFS"</span></span>
<span><span class="co">#&gt;               trt trt_cd curve eventtime event</span></span>
<span><span class="co">#&gt; 425 Dinutuximab β    GD2   EFS     0.013     1</span></span>
<span><span class="co">#&gt; 426 Dinutuximab β    GD2   EFS     0.013     1</span></span>
<span><span class="co">#&gt; 427 Dinutuximab β    GD2   EFS     0.013     1</span></span>
<span><span class="co">#&gt; 428 Dinutuximab β    GD2   EFS     0.013     1</span></span>
<span><span class="co">#&gt; 429 Dinutuximab β    GD2   EFS     0.046     1</span></span>
<span><span class="co">#&gt; 620 Dinutuximab β    GD2   EFS     7.000     0</span></span>
<span><span class="co">#&gt; 621 Dinutuximab β    GD2   EFS     7.000     0</span></span>
<span><span class="co">#&gt; 622 Dinutuximab β    GD2   EFS     7.000     0</span></span>
<span><span class="co">#&gt; 623 Dinutuximab β    GD2   EFS     7.000     0</span></span>
<span><span class="co">#&gt; 624 Dinutuximab β    GD2   EFS     7.000     0</span></span>
<span><span class="co">#&gt; [1] "Isotretinoin EFS"</span></span>
<span><span class="co">#&gt;              trt trt_cd curve   eventtime event</span></span>
<span><span class="co">#&gt; 113 Isotretinoin     TT   EFS  0.03278242     1</span></span>
<span><span class="co">#&gt; 114 Isotretinoin     TT   EFS  0.03278242     1</span></span>
<span><span class="co">#&gt; 115 Isotretinoin     TT   EFS  0.04538207     1</span></span>
<span><span class="co">#&gt; 116 Isotretinoin     TT   EFS  0.07793117     1</span></span>
<span><span class="co">#&gt; 117 Isotretinoin     TT   EFS  0.12202994     1</span></span>
<span><span class="co">#&gt; 220 Isotretinoin     TT   EFS 14.70647482     0</span></span>
<span><span class="co">#&gt; 221 Isotretinoin     TT   EFS 14.70647482     0</span></span>
<span><span class="co">#&gt; 222 Isotretinoin     TT   EFS 14.70647482     0</span></span>
<span><span class="co">#&gt; 223 Isotretinoin     TT   EFS 14.70647482     0</span></span>
<span><span class="co">#&gt; 224 Isotretinoin     TT   EFS 14.70647482     0</span></span>
<span><span class="co">#&gt; [1] "Dinutuximab β OS"</span></span>
<span><span class="co">#&gt;               trt trt_cd curve eventtime event</span></span>
<span><span class="co">#&gt; 225 Dinutuximab β    GD2    OS 0.1504637     1</span></span>
<span><span class="co">#&gt; 226 Dinutuximab β    GD2    OS 0.1985816     1</span></span>
<span><span class="co">#&gt; 227 Dinutuximab β    GD2    OS 0.2908074     1</span></span>
<span><span class="co">#&gt; 228 Dinutuximab β    GD2    OS 0.2908074     1</span></span>
<span><span class="co">#&gt; 229 Dinutuximab β    GD2    OS 0.3212821     1</span></span>
<span><span class="co">#&gt; 420 Dinutuximab β    GD2    OS 6.9671577     0</span></span>
<span><span class="co">#&gt; 421 Dinutuximab β    GD2    OS 6.9671577     0</span></span>
<span><span class="co">#&gt; 422 Dinutuximab β    GD2    OS 6.9671577     0</span></span>
<span><span class="co">#&gt; 423 Dinutuximab β    GD2    OS 6.9671577     0</span></span>
<span><span class="co">#&gt; 424 Dinutuximab β    GD2    OS 6.9671577     0</span></span>
<span><span class="co">#&gt; [1] "Isotretinoin OS"</span></span>
<span><span class="co">#&gt;              trt trt_cd curve   eventtime event</span></span>
<span><span class="co">#&gt; 1   Isotretinoin     TT    OS  0.09677419     1</span></span>
<span><span class="co">#&gt; 2   Isotretinoin     TT    OS  0.30162856     1</span></span>
<span><span class="co">#&gt; 3   Isotretinoin     TT    OS  0.38686900     1</span></span>
<span><span class="co">#&gt; 4   Isotretinoin     TT    OS  0.38686900     1</span></span>
<span><span class="co">#&gt; 5   Isotretinoin     TT    OS  0.44697776     1</span></span>
<span><span class="co">#&gt; 108 Isotretinoin     TT    OS 14.72539931     0</span></span>
<span><span class="co">#&gt; 109 Isotretinoin     TT    OS 14.72539931     0</span></span>
<span><span class="co">#&gt; 110 Isotretinoin     TT    OS 14.72539931     0</span></span>
<span><span class="co">#&gt; 111 Isotretinoin     TT    OS 14.72539931     0</span></span>
<span><span class="co">#&gt; 112 Isotretinoin     TT    OS 14.72539931     0</span></span>
<span></span>
<span><span class="co"># Split IPD by curves: </span></span>
<span><span class="va">IPD_curves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">IPD_data</span>,</span>
<span>  f <span class="op">=</span> <span class="va">IPD_data</span><span class="op">$</span><span class="va">curve</span> </span>
<span><span class="op">)</span></span></code></pre></div>
<p>Utilizing the {survival} package, the <code>Surv()</code> function
generates a survival object suitable for being the response in a model’s
formula. Each subject is represented by their survival time in this
object, with censored subjects marked by a <code>+</code>. Here’s a
glimpse at the reconstructed individual patient data (IPD):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IPD_curves_trts</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`names&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IPD_curves_trts</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">trt_curve_nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">surv_data</span> <span class="op">&lt;-</span> <span class="va">IPD_curves_trts</span><span class="op">[[</span><span class="va">trt_curve_nm</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">surv_obj</span> <span class="op">&lt;-</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span></span>
<span>      time <span class="op">=</span> <span class="va">surv_data</span><span class="op">$</span><span class="va">eventtime</span>,</span>
<span>      event <span class="op">=</span> <span class="va">surv_data</span><span class="op">$</span><span class="va">event</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\."</span>, <span class="st">" "</span>, <span class="va">trt_curve_nm</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">surv_obj</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">surv_obj</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Dinutuximab β EFS"</span></span>
<span><span class="co">#&gt;  [1] 0.013  0.013  0.013  0.013  0.046  7.000+ 7.000+ 7.000+ 7.000+ 7.000+</span></span>
<span><span class="co">#&gt; [1] "Isotretinoin EFS"</span></span>
<span><span class="co">#&gt;  [1]  0.03278242   0.03278242   0.04538207   0.07793117   0.12202994 </span></span>
<span><span class="co">#&gt;  [6] 14.70647482+ 14.70647482+ 14.70647482+ 14.70647482+ 14.70647482+</span></span>
<span><span class="co">#&gt; [1] "Dinutuximab β OS"</span></span>
<span><span class="co">#&gt;  [1] 0.1504637  0.1985816  0.2908074  0.2908074  0.3212821  6.9671577+</span></span>
<span><span class="co">#&gt;  [7] 6.9671577+ 6.9671577+ 6.9671577+ 6.9671577+</span></span>
<span><span class="co">#&gt; [1] "Isotretinoin OS"</span></span>
<span><span class="co">#&gt;  [1]  0.09677419   0.30162856   0.38686900   0.38686900   0.44697776 </span></span>
<span><span class="co">#&gt;  [6] 14.72539931+ 14.72539931+ 14.72539931+ 14.72539931+ 14.72539931+</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="non-parametric-methods-kaplan-meier-curves">Non-Parametric Methods: Kaplan-Meier Curves<a class="anchor" aria-label="anchor" href="#non-parametric-methods-kaplan-meier-curves"></a>
</h2>
<p>The Kaplan-Meier method is a cornerstone of survival analysis,
offering a straightforward way to estimate survival probabilities
without assuming a specific statistical distribution for the event
times. This method employs a non-parametric technique to produce a step
function that decreases each time an event is observed.</p>
<p>To construct survival curves employing the Kaplan-Meier method, one
can use the <code>survfit()</code> function. By applying this function,
a survival curve for each treatment is created.</p>
<div class="section level3">
<h3 id="kaplan-meier-estimeates">Kaplan-Meier estimeates:<a class="anchor" aria-label="anchor" href="#kaplan-meier-estimeates"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># KM curves:</span></span>
<span><span class="va">survival_curves_estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IPD_curves_trts</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`names&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IPD_curves_trts</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">trt_curve_nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">surv_data</span> <span class="op">&lt;-</span> <span class="va">IPD_curves_trts</span><span class="op">[[</span><span class="va">trt_curve_nm</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">surv_obj</span> <span class="op">&lt;-</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span></span>
<span>      formula <span class="op">=</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">eventtime</span>, event <span class="op">=</span> <span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>      data <span class="op">=</span> <span class="va">IPD_curves_trts</span><span class="op">[[</span><span class="va">trt_curve_nm</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"kaplan-meier"</span>,</span>
<span>      conf.type <span class="op">=</span> <span class="st">"log-log"</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trt_curve_nm</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">surv_obj</span>, </span>
<span>      print.rmean <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "Dinutuximab β.EFS"</span></span>
<span><span class="co">#&gt; Call: survfit(formula = survival::Surv(time = eventtime, event = event) ~ </span></span>
<span><span class="co">#&gt;     1, data = IPD_curves_trts[[trt_curve_nm]], type = "kaplan-meier", </span></span>
<span><span class="co">#&gt;     conf.type = "log-log")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        n events rmean* se(rmean) median 0.95LCL 0.95UCL</span></span>
<span><span class="co">#&gt; [1,] 200     92   4.21     0.217     NA    2.64      NA</span></span>
<span><span class="co">#&gt;     * restricted mean with upper limit =  7 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "Isotretinoin.EFS"</span></span>
<span><span class="co">#&gt; Call: survfit(formula = survival::Surv(time = eventtime, event = event) ~ </span></span>
<span><span class="co">#&gt;     1, data = IPD_curves_trts[[trt_curve_nm]], type = "kaplan-meier", </span></span>
<span><span class="co">#&gt;     conf.type = "log-log")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        n events rmean* se(rmean) median 0.95LCL 0.95UCL</span></span>
<span><span class="co">#&gt; [1,] 112     62   7.22     0.645   1.97    1.34      NA</span></span>
<span><span class="co">#&gt;     * restricted mean with upper limit =  14.7 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "Dinutuximab β.OS"</span></span>
<span><span class="co">#&gt; Call: survfit(formula = survival::Surv(time = eventtime, event = event) ~ </span></span>
<span><span class="co">#&gt;     1, data = IPD_curves_trts[[trt_curve_nm]], type = "kaplan-meier", </span></span>
<span><span class="co">#&gt;     conf.type = "log-log")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        n events rmean* se(rmean) median 0.95LCL 0.95UCL</span></span>
<span><span class="co">#&gt; [1,] 200     71   5.02      0.19     NA      NA      NA</span></span>
<span><span class="co">#&gt;     * restricted mean with upper limit =  6.97 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "Isotretinoin.OS"</span></span>
<span><span class="co">#&gt; Call: survfit(formula = survival::Surv(time = eventtime, event = event) ~ </span></span>
<span><span class="co">#&gt;     1, data = IPD_curves_trts[[trt_curve_nm]], type = "kaplan-meier", </span></span>
<span><span class="co">#&gt;     conf.type = "log-log")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        n events rmean* se(rmean) median 0.95LCL 0.95UCL</span></span>
<span><span class="co">#&gt; [1,] 112     53   8.93     0.588     NA    4.41      NA</span></span>
<span><span class="co">#&gt;     * restricted mean with upper limit =  14.7</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="kaplan-meier-plots">Kaplan-Meier plots:<a class="anchor" aria-label="anchor" href="#kaplan-meier-plots"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># KM curves:</span></span>
<span><span class="va">survival_curves_km</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IPD_curves_trts</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`names&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IPD_curves_trts</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">trt_curve_nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">surv_data</span> <span class="op">&lt;-</span> <span class="va">IPD_curves_trts</span><span class="op">[[</span><span class="va">trt_curve_nm</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">surv_obj</span> <span class="op">&lt;-</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span></span>
<span>      formula <span class="op">=</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">eventtime</span>, event <span class="op">=</span> <span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>      data <span class="op">=</span> <span class="va">IPD_curves_trts</span><span class="op">[[</span><span class="va">trt_curve_nm</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>      <span class="va">surv_obj</span>,</span>
<span>      main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>        <span class="st">"Kaplan-Meier Curve for "</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span></span>
<span>          pattern <span class="op">=</span> <span class="st">"\\."</span>,</span>
<span>          replacement <span class="op">=</span> <span class="st">" "</span>,</span>
<span>          x <span class="op">=</span> <span class="va">trt_curve_nm</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      xlab <span class="op">=</span> <span class="st">"Time (years)"</span>,</span>
<span>      ylab <span class="op">=</span> <span class="st">"Survival probability"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Survival_functions_files/figure-html/km_curves-1.png" width="768"><img src="Survival_functions_files/figure-html/km_curves-2.png" width="768"><img src="Survival_functions_files/figure-html/km_curves-3.png" width="768"><img src="Survival_functions_files/figure-html/km_curves-4.png" width="768"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># KM curves, by treatment:</span></span>
<span><span class="va">survival_curves_trt_km</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IPD_curves</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`names&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IPD_curves</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">curve_nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">surv_obj</span> <span class="op">&lt;-</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span></span>
<span>      formula <span class="op">=</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">eventtime</span>, event <span class="op">=</span> <span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="va">trt</span>,</span>
<span>      data <span class="op">=</span> <span class="va">IPD_curves</span><span class="op">[[</span><span class="va">curve_nm</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">surv_plot</span> <span class="op">&lt;-</span> <span class="fu">survminer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survminer/man/ggsurvplot.html" class="external-link">ggsurvplot</a></span><span class="op">(</span></span>
<span>      fit <span class="op">=</span> <span class="va">surv_obj</span>,</span>
<span>      data <span class="op">=</span> <span class="va">IPD_curves</span><span class="op">[[</span><span class="va">curve_nm</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      risk.table <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      title <span class="op">=</span> <span class="va">curve_nm</span>,</span>
<span>      legend <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>      legend.title <span class="op">=</span> <span class="st">"Treatment"</span>,</span>
<span>      legend.labs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">IPD_curves</span><span class="op">[[</span><span class="va">curve_nm</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"trt"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">surv_plot</span><span class="op">$</span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="va">surv_plot</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> </span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title.position <span class="op">=</span> <span class="st">"plot"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">surv_plot</span><span class="op">)</span></span>
<span>    <span class="va">surv_obj</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Survival_functions_files/figure-html/km_curves-5.png" width="768"><img src="Survival_functions_files/figure-html/km_curves-6.png" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="fitting-parametric-models">Fitting parametric models:<a class="anchor" aria-label="anchor" href="#fitting-parametric-models"></a>
</h2>
<p>Parametric models assume a specific statistical distribution for the
time-to-event data. This assumption allows for the extrapolation of
survival estimates beyond the range of observed data, which is
particularly useful in long-term survival predictions where follow-up
may not be sufficiently long.</p>
<div class="section level3">
<h3 id="parametric-models-using-maximum-likelihood-estimates-mles">Parametric models using maximum likelihood estimates (MLEs):<a class="anchor" aria-label="anchor" href="#parametric-models-using-maximum-likelihood-estimates-mles"></a>
</h3>
<div class="section level4">
<h4 id="fitting-independent-survival-cuves">Fitting independent survival cuves:<a class="anchor" aria-label="anchor" href="#fitting-independent-survival-cuves"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Define models to be used</span></span>
<span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exponential"</span>, <span class="st">"gamma"</span>, <span class="st">"gengamma"</span>, <span class="st">"gompertz"</span>, <span class="st">"weibull"</span>, <span class="st">"loglogistic"</span>, <span class="st">"lognormal"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Write formula specifying the predictor</span></span>
<span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">eventtime</span>, event <span class="op">=</span> <span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># Fit parametric models:</span></span>
<span><span class="va">parametric_models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IPD_curves_trts</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`names&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IPD_curves_trts</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">curves_trts_nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">surv_data</span> <span class="op">&lt;-</span> <span class="va">IPD_curves_trts</span><span class="op">[[</span><span class="va">curves_trts_nm</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">surv_parametric_models</span> <span class="op">&lt;-</span> <span class="fu">survHE</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survHE/man/fit.models.html" class="external-link">fit.models</a></span><span class="op">(</span></span>
<span>      formula <span class="op">=</span> <span class="va">formula</span>, </span>
<span>      data <span class="op">=</span> <span class="va">surv_data</span>, </span>
<span>      distr <span class="op">=</span> <span class="va">models</span>,</span>
<span>      method <span class="op">=</span> <span class="st">"mle"</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">survHE</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survHE/man/model.fit.plot.html" class="external-link">model.fit.plot</a></span><span class="op">(</span></span>
<span>      <span class="va">surv_parametric_models</span>,</span>
<span>      scale <span class="op">=</span> <span class="st">"relative"</span></span>
<span>    <span class="op">)</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>      <span class="va">p</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>          plot.title.position <span class="op">=</span> <span class="st">"plot"</span>,</span>
<span>          text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">surv_parametric_models</span>, add.km <span class="op">=</span> <span class="cn">TRUE</span>, t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>      <span class="va">p</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>          title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>            <span class="st">"MLE fitted parameteric models - "</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span></span>
<span>              pattern <span class="op">=</span> <span class="st">"\\."</span>,</span>
<span>              replacement <span class="op">=</span> <span class="st">" "</span>,</span>
<span>              <span class="va">curves_trts_nm</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title.position <span class="op">=</span> <span class="st">"plot"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>      X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">models</span><span class="op">)</span>,</span>
<span>      FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">param_model</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">surv_parametric_models</span>, mod <span class="op">=</span> <span class="va">param_model</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">surv_parametric_models</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Survival_functions_files/figure-html/parametric_models_mle-1.png" width="768"><img src="Survival_functions_files/figure-html/parametric_models_mle-2.png" width="768"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Exponential model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.017 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          mean        se      L95%    U95%</span></span>
<span><span class="co">#&gt; rate 0.118862 0.0123922 0.0968946 0.14581</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 577.882</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 581.180</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Gamma model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.022 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean        se      L95%     U95%</span></span>
<span><span class="co">#&gt; shape 0.4616622 0.0519674 0.3702611 0.575626</span></span>
<span><span class="co">#&gt; rate  0.0275372 0.0086535 0.0148742 0.050981</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 522.387</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 528.984</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Generalised Gamma model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.031 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean       se      L95%      U95%</span></span>
<span><span class="co">#&gt; mu     0.775818 0.508490 -0.220805  1.772440</span></span>
<span><span class="co">#&gt; sigma  3.024955 0.237000  2.594351  3.527030</span></span>
<span><span class="co">#&gt; Q     -1.137416 0.410403 -1.941791 -0.333042</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 494.155</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 504.050</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Gompertz model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.011 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean        se      L95%      U95%</span></span>
<span><span class="co">#&gt; shape -0.771794 0.0969359 -0.961785 -0.581803</span></span>
<span><span class="co">#&gt; rate   0.488828 0.0706664  0.368217  0.648946</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 466.408</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 473.004</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Weibull AF model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.007 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean        se     L95%      U95%</span></span>
<span><span class="co">#&gt; shape  0.515831 0.0486057 0.428845  0.620461</span></span>
<span><span class="co">#&gt; scale 13.958535 3.2335174 8.864569 21.979716</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 515.124</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 521.720</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the log-Logistic model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.007 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           mean        se     L95%     U95%</span></span>
<span><span class="co">#&gt; shape 0.631024 0.0570624 0.528535 0.753388</span></span>
<span><span class="co">#&gt; scale 6.222788 1.4408348 3.952723 9.796561</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 505.164</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 511.761</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the log-Normal model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.007 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean       se    L95%    U95%</span></span>
<span><span class="co">#&gt; meanlog 1.90977 0.244549 1.43047 2.38908</span></span>
<span><span class="co">#&gt; sdlog   2.68246 0.224748 2.27623 3.16119</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 498.888</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 505.485</span></span></code></pre>
<p><img src="Survival_functions_files/figure-html/parametric_models_mle-3.png" width="768"><img src="Survival_functions_files/figure-html/parametric_models_mle-4.png" width="768"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Exponential model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.006 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           mean         se      L95%     U95%</span></span>
<span><span class="co">#&gt; rate 0.0766774 0.00973803 0.0597812 0.098349</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 444.450</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 447.169</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Gamma model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.018 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean         se       L95%      U95%</span></span>
<span><span class="co">#&gt; shape 0.3522684 0.04824272 0.26934117 0.4607281</span></span>
<span><span class="co">#&gt; rate  0.0114968 0.00475699 0.00510951 0.0258687</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 369.127</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 374.564</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Generalised Gamma model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.025 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean       se     L95%      U95%</span></span>
<span><span class="co">#&gt; mu    -0.431465 0.443078 -1.29988  0.436951</span></span>
<span><span class="co">#&gt; sigma  2.367955 0.266802  1.89875  2.953111</span></span>
<span><span class="co">#&gt; Q     -2.138324 0.440109 -3.00092 -1.275727</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 322.903</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 331.058</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Gompertz model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.010 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean        se      L95%      U95%</span></span>
<span><span class="co">#&gt; shape -0.676088 0.0959712 -0.864188 -0.487988</span></span>
<span><span class="co">#&gt; rate   0.549287 0.0935185  0.393440  0.766867</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 301.333</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 306.770</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Weibull AF model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.005 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean        se      L95%      U95%</span></span>
<span><span class="co">#&gt; shape  0.420334 0.0470044  0.337604  0.523337</span></span>
<span><span class="co">#&gt; scale 18.841571 6.0402440 10.051673 35.317984</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 359.662</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 365.099</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the log-Logistic model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.008 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          mean        se     L95%      U95%</span></span>
<span><span class="co">#&gt; shape 0.55806 0.0599002 0.452185  0.688725</span></span>
<span><span class="co">#&gt; scale 5.81790 1.8848386 3.083193 10.978223</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 347.842</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 353.279</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the log-Normal model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.006 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean       se    L95%    U95%</span></span>
<span><span class="co">#&gt; meanlog 1.88720 0.317390 1.26512 2.50927</span></span>
<span><span class="co">#&gt; sdlog   2.88844 0.293455 2.36692 3.52486</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 342.065</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 347.502</span></span></code></pre>
<p><img src="Survival_functions_files/figure-html/parametric_models_mle-5.png" width="768"><img src="Survival_functions_files/figure-html/parametric_models_mle-6.png" width="768"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Exponential model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.005 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           mean         se      L95%      U95%</span></span>
<span><span class="co">#&gt; rate 0.0767895 0.00911324 0.0608531 0.0968994</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 508.470</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 511.768</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Gamma model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.014 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean        se      L95%      U95%</span></span>
<span><span class="co">#&gt; shape 0.6791529 0.0890740 0.5252047 0.8782265</span></span>
<span><span class="co">#&gt; rate  0.0358905 0.0116217 0.0190262 0.0677029</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 500.959</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 507.556</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Generalised Gamma model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.031 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean       se      L95%     U95%</span></span>
<span><span class="co">#&gt; mu     0.420406 0.384705 -0.333602  1.17441</span></span>
<span><span class="co">#&gt; sigma  1.958011 0.232639  1.551246  2.47144</span></span>
<span><span class="co">#&gt; Q     -2.835463 0.629894 -4.070032 -1.60089</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 467.018</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 476.913</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Gompertz model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.010 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean        se      L95%      U95%</span></span>
<span><span class="co">#&gt; shape -0.437065 0.0785317 -0.590984 -0.283146</span></span>
<span><span class="co">#&gt; rate   0.208811 0.0365708  0.148141  0.294328</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 470.201</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 476.797</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Weibull AF model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.005 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean        se     L95%     U95%</span></span>
<span><span class="co">#&gt; shape  0.700754 0.0764506  0.56585  0.86782</span></span>
<span><span class="co">#&gt; scale 18.891490 4.1623803 12.26649 29.09459</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 498.258</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 504.855</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the log-Logistic model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.005 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean        se     L95%      U95%</span></span>
<span><span class="co">#&gt; shape  0.813059 0.0849182 0.662552  0.997755</span></span>
<span><span class="co">#&gt; scale 11.276649 2.3819685 7.453850 17.060019</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 492.135</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 498.732</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the log-Normal model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.007 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean       se    L95%    U95%</span></span>
<span><span class="co">#&gt; meanlog 2.47599 0.224609 2.03577 2.91622</span></span>
<span><span class="co">#&gt; sdlog   2.07430 0.202461 1.71313 2.51161</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 484.194</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 490.790</span></span></code></pre>
<p><img src="Survival_functions_files/figure-html/parametric_models_mle-7.png" width="768"><img src="Survival_functions_files/figure-html/parametric_models_mle-8.png" width="768"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Exponential model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.005 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           mean         se      L95%      U95%</span></span>
<span><span class="co">#&gt; rate 0.0529694 0.00727591 0.0404673 0.0693341</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 419.432</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 422.151</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Gamma model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.015 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean         se       L95%      U95%</span></span>
<span><span class="co">#&gt; shape 0.5484131 0.08420805 0.40588874 0.7409836</span></span>
<span><span class="co">#&gt; rate  0.0179479 0.00679396 0.00854672 0.0376899</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 403.768</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 409.205</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Generalised Gamma model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.025 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           mean       se      L95%      U95%</span></span>
<span><span class="co">#&gt; mu     1.01720 0.430972  0.172514  1.861894</span></span>
<span><span class="co">#&gt; sigma  2.17596 0.239791  1.753272  2.700562</span></span>
<span><span class="co">#&gt; Q     -1.90444 0.483808 -2.852686 -0.956192</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 377.339</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 385.495</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Gompertz model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.009 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean        se      L95%      U95%</span></span>
<span><span class="co">#&gt; shape -0.316976 0.0538467 -0.422513 -0.211438</span></span>
<span><span class="co">#&gt; rate   0.199665 0.0382986  0.137098  0.290787</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 364.319</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 369.756</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Weibull AF model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.005 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           mean        se     L95%      U95%</span></span>
<span><span class="co">#&gt; shape  0.59362 0.0737995  0.46525  0.757409</span></span>
<span><span class="co">#&gt; scale 27.22828 7.1596769 16.26285 45.587279</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 399.691</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 405.128</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the log-Logistic model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.012 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean        se     L95%      U95%</span></span>
<span><span class="co">#&gt; shape  0.738167 0.0875116 0.585117  0.931251</span></span>
<span><span class="co">#&gt; scale 13.026802 3.3994377 7.811072 21.725260</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 392.443</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 397.880</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the log-Normal model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.006 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean       se    L95%    U95%</span></span>
<span><span class="co">#&gt; meanlog 2.63022 0.265965 2.10894 3.15150</span></span>
<span><span class="co">#&gt; sdlog   2.22122 0.247771 1.78502 2.76402</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 387.246</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 392.683</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="fitting-survival-curves-by-treatment">Fitting survival curves by treatment:<a class="anchor" aria-label="anchor" href="#fitting-survival-curves-by-treatment"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Define models to be used</span></span>
<span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exponential"</span>, <span class="st">"gamma"</span>, <span class="st">"gengamma"</span>, <span class="st">"gompertz"</span>, <span class="st">"weibull"</span>, <span class="st">"weibullPH"</span>, <span class="st">"loglogistic"</span>, <span class="st">"lognormal"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Write formula specifying the predictor</span></span>
<span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">eventtime</span>, event <span class="op">=</span> <span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">trt</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit parametric models:</span></span>
<span><span class="va">parametric_models_trt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IPD_curves</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`names&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IPD_curves</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">curves_nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">surv_data</span> <span class="op">&lt;-</span> <span class="va">IPD_curves</span><span class="op">[[</span><span class="va">curves_nm</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">surv_parametric_models</span> <span class="op">&lt;-</span> <span class="fu">survHE</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survHE/man/fit.models.html" class="external-link">fit.models</a></span><span class="op">(</span></span>
<span>      formula <span class="op">=</span> <span class="va">formula</span>, </span>
<span>      data <span class="op">=</span> <span class="va">surv_data</span>, </span>
<span>      distr <span class="op">=</span> <span class="va">models</span>,</span>
<span>      method <span class="op">=</span> <span class="st">"mle"</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">survHE</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survHE/man/model.fit.plot.html" class="external-link">model.fit.plot</a></span><span class="op">(</span></span>
<span>      <span class="va">surv_parametric_models</span>,</span>
<span>      scale <span class="op">=</span> <span class="st">"relative"</span></span>
<span>    <span class="op">)</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>      <span class="va">p</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>          plot.title.position <span class="op">=</span> <span class="st">"plot"</span>,</span>
<span>          text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">surv_parametric_models</span>, add.km <span class="op">=</span> <span class="cn">TRUE</span>, t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>      <span class="va">p</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>          title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>            <span class="st">"MLE fitted parameteric models - "</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span></span>
<span>              pattern <span class="op">=</span> <span class="st">"\\."</span>,</span>
<span>              replacement <span class="op">=</span> <span class="st">" "</span>,</span>
<span>              <span class="va">curves_nm</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>          plot.title.position <span class="op">=</span> <span class="st">"plot"</span>,</span>
<span>          <span class="co"># legend.text = ggplot2::element_text(size = 8),</span></span>
<span>          <span class="co"># legend.title = ggplot2::element_text(size = 8)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>      X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">models</span><span class="op">)</span>,</span>
<span>      FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">param_model</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">surv_parametric_models</span>, mod <span class="op">=</span> <span class="va">param_model</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">surv_parametric_models</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Survival_functions_files/figure-html/parametric_models-1.png" width="768"><img src="Survival_functions_files/figure-html/parametric_models-2.png" width="768"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Exponential model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.008 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                 mean        se       L95%      U95%</span></span>
<span><span class="co">#&gt; rate                        0.118862 0.0123922  0.0968946  0.145810</span></span>
<span><span class="co">#&gt; as.factor(trt)Isotretinoin -0.438358 0.1643125 -0.7604044 -0.116311</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 1022.332</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 1029.818</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Gamma model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.034 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                  mean         se       L95%      U95%</span></span>
<span><span class="co">#&gt; shape                       0.4112712 0.03572089  0.3468944 0.4875950</span></span>
<span><span class="co">#&gt; rate                        0.0210414 0.00614059  0.0118759 0.0372807</span></span>
<span><span class="co">#&gt; as.factor(trt)Isotretinoin -0.2660013 0.31656550 -0.8864583 0.3544557</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 891.870</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 903.099</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Generalised Gamma model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.060 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                   mean       se      L95%      U95%</span></span>
<span><span class="co">#&gt; mu                          0.28951910 0.398744 -0.492005  1.071043</span></span>
<span><span class="co">#&gt; sigma                       2.87338994 0.178113  2.544667  3.244577</span></span>
<span><span class="co">#&gt; Q                          -1.50188010 0.285066 -2.060599 -0.943161</span></span>
<span><span class="co">#&gt; as.factor(trt)Isotretinoin -0.00122724 0.349128 -0.685505  0.683051</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 817.839</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 832.811</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Gompertz model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.024 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                 mean        se       L95%      U95%</span></span>
<span><span class="co">#&gt; shape                      -0.726308 0.0689758 -0.8614983 -0.591118</span></span>
<span><span class="co">#&gt; rate                        0.465813 0.0598415  0.3621262  0.599187</span></span>
<span><span class="co">#&gt; as.factor(trt)Isotretinoin  0.222220 0.1643144 -0.0998302  0.544271</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 766.230</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 777.459</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Weibull AF model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.008 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                  mean        se      L95%      U95%</span></span>
<span><span class="co">#&gt; shape                       0.4708127 0.0338952  0.408853  0.542162</span></span>
<span><span class="co">#&gt; scale                      15.6867205 3.7969324  9.761148 25.209452</span></span>
<span><span class="co">#&gt; as.factor(trt)Isotretinoin  0.0847999 0.3514551 -0.604040  0.773639</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 874.771</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 886.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Weibull PH model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.008 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                  mean        se      L95%     U95%</span></span>
<span><span class="co">#&gt; shape                       0.4708127 0.0338952  0.408853 0.542162</span></span>
<span><span class="co">#&gt; scale                       0.2736077 0.0313235  0.218615 0.342434</span></span>
<span><span class="co">#&gt; as.factor(trt)Isotretinoin -0.0399249 0.1658334 -0.364952 0.285103</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 874.771</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 886.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the log-Logistic model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.008 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                 mean        se      L95%      U95%</span></span>
<span><span class="co">#&gt; shape                       0.598128 0.0413215  0.522383  0.684855</span></span>
<span><span class="co">#&gt; scale                       6.577741 1.5502123  4.144474 10.439606</span></span>
<span><span class="co">#&gt; as.factor(trt)Isotretinoin -0.180774 0.3688524 -0.903711  0.542164</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 851.780</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 863.009</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the log-Normal model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.011 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                 mean       se      L95%     U95%</span></span>
<span><span class="co">#&gt; meanlog                     1.955391 0.239781  1.485429 2.425353</span></span>
<span><span class="co">#&gt; sdlog                       2.767214 0.178823  2.438015 3.140863</span></span>
<span><span class="co">#&gt; as.factor(trt)Isotretinoin -0.117646 0.357465 -0.818265 0.582973</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 839.272</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 850.501</span></span></code></pre>
<p><img src="Survival_functions_files/figure-html/parametric_models-3.png" width="768"><img src="Survival_functions_files/figure-html/parametric_models-4.png" width="768"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Exponential model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.007 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                  mean         se       L95%       U95%</span></span>
<span><span class="co">#&gt; rate                        0.0767895 0.00911324  0.0608531  0.0968994</span></span>
<span><span class="co">#&gt; as.factor(trt)Isotretinoin -0.3713533 0.18152805 -0.7271417 -0.0155649</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 927.902</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 935.388</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Gamma model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.034 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                  mean         se      L95%      U95%</span></span>
<span><span class="co">#&gt; shape                       0.6181381 0.06159460  0.508472 0.7514565</span></span>
<span><span class="co">#&gt; rate                        0.0291709 0.00825689  0.016750 0.0508024</span></span>
<span><span class="co">#&gt; as.factor(trt)Isotretinoin -0.2484417 0.26148253 -0.760938 0.2640546</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 903.851</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 915.080</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Generalised Gamma model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.070 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                  mean       se      L95%      U95%</span></span>
<span><span class="co">#&gt; mu                          0.7626838 0.294464  0.185546  1.339822</span></span>
<span><span class="co">#&gt; sigma                       2.1024632 0.163794  1.804741  2.449299</span></span>
<span><span class="co">#&gt; Q                          -2.2764560 0.384736 -3.030525 -1.522387</span></span>
<span><span class="co">#&gt; as.factor(trt)Isotretinoin -0.0180095 0.250363 -0.508711  0.472692</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 841.795</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 856.767</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Gompertz model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.017 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                 mean        se      L95%      U95%</span></span>
<span><span class="co">#&gt; shape                      -0.359927 0.0460278 -0.450140 -0.269715</span></span>
<span><span class="co">#&gt; rate                        0.182694 0.0265867  0.137358  0.242994</span></span>
<span><span class="co">#&gt; as.factor(trt)Isotretinoin  0.189991 0.1824706 -0.167644  0.547627</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 834.131</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 845.360</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Weibull AF model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.007 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                 mean        se      L95%      U95%</span></span>
<span><span class="co">#&gt; shape                       0.649354 0.0532257  0.552982  0.762521</span></span>
<span><span class="co">#&gt; scale                      20.941809 4.5328734 13.701586 32.007926</span></span>
<span><span class="co">#&gt; as.factor(trt)Isotretinoin  0.177736 0.2828866 -0.376711  0.732184</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 896.963</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 908.192</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Weibull PH model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.007 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                 mean        se      L95%     U95%</span></span>
<span><span class="co">#&gt; shape                       0.649354 0.0532257  0.552982 0.762521</span></span>
<span><span class="co">#&gt; scale                       0.138738 0.0203823  0.104026 0.185032</span></span>
<span><span class="co">#&gt; as.factor(trt)Isotretinoin -0.115414 0.1853777 -0.478747 0.247920</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 896.963</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 908.192</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the log-Logistic model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.008 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                  mean        se      L95%      U95%</span></span>
<span><span class="co">#&gt; shape                       0.7782543 0.0609471  0.667516  0.907363</span></span>
<span><span class="co">#&gt; scale                      11.8431864 2.4415556  7.906557 17.739841</span></span>
<span><span class="co">#&gt; as.factor(trt)Isotretinoin  0.0529205 0.2974335 -0.530038  0.635879</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 882.954</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 894.183</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the log-Normal model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.011 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                 mean       se      L95%     U95%</span></span>
<span><span class="co">#&gt; meanlog                    2.5213424 0.210812  2.108158 2.934527</span></span>
<span><span class="co">#&gt; sdlog                      2.1388640 0.157040  1.852192 2.469906</span></span>
<span><span class="co">#&gt; as.factor(trt)Isotretinoin 0.0662944 0.288606 -0.499363 0.631952</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 869.654</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 880.883</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="best-parametric-model">Best parametric model:<a class="anchor" aria-label="anchor" href="#best-parametric-model"></a>
</h3>
<p>The <strong>Gompertz</strong> model seems to best fits the data and
offers the best predictive performance for the survival curves of both
interventions.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Define models to be used</span></span>
<span><span class="va">models</span> <span class="op">&lt;-</span> <span class="st">"gompertz"</span> </span>
<span></span>
<span><span class="co"># Write formula specifying the predictor</span></span>
<span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">eventtime</span>, event <span class="op">=</span> <span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># Fit parametric models:</span></span>
<span><span class="va">parametric_models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IPD_curves_trts</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`names&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IPD_curves_trts</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">curves_trts_nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">surv_data</span> <span class="op">&lt;-</span> <span class="va">IPD_curves_trts</span><span class="op">[[</span><span class="va">curves_trts_nm</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">surv_parametric_models</span> <span class="op">&lt;-</span> <span class="fu">survHE</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survHE/man/fit.models.html" class="external-link">fit.models</a></span><span class="op">(</span></span>
<span>      formula <span class="op">=</span> <span class="va">formula</span>, </span>
<span>      data <span class="op">=</span> <span class="va">surv_data</span>, </span>
<span>      distr <span class="op">=</span> <span class="va">models</span>,</span>
<span>      method <span class="op">=</span> <span class="st">"mle"</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>      <span class="va">surv_parametric_models</span>, </span>
<span>      add.km <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>      t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, </span>
<span>      legend.position <span class="op">=</span> <span class="st">"none"</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>      <span class="va">p</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>          title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>            <span class="st">"Gompertz fitted models - "</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span></span>
<span>              pattern <span class="op">=</span> <span class="st">"\\."</span>,</span>
<span>              replacement <span class="op">=</span> <span class="st">" "</span>,</span>
<span>              <span class="va">curves_trts_nm</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title.position <span class="op">=</span> <span class="st">"plot"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>      X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">models</span><span class="op">)</span>,</span>
<span>      FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">param_model</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">surv_parametric_models</span>, mod <span class="op">=</span> <span class="va">param_model</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">surv_parametric_models</span><span class="op">$</span><span class="va">models</span><span class="op">$</span><span class="va">Gompertz</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Survival_functions_files/figure-html/gompertz_models-1.png" width="768"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Gompertz model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.011 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean        se      L95%      U95%</span></span>
<span><span class="co">#&gt; shape -0.771794 0.0969359 -0.961785 -0.581803</span></span>
<span><span class="co">#&gt; rate   0.488828 0.0706664  0.368217  0.648946</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 466.408</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 473.004</span></span></code></pre>
<p><img src="Survival_functions_files/figure-html/gompertz_models-2.png" width="768"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Gompertz model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.010 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean        se      L95%      U95%</span></span>
<span><span class="co">#&gt; shape -0.676088 0.0959712 -0.864188 -0.487988</span></span>
<span><span class="co">#&gt; rate   0.549287 0.0935185  0.393440  0.766867</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 301.333</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 306.770</span></span></code></pre>
<p><img src="Survival_functions_files/figure-html/gompertz_models-3.png" width="768"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Gompertz model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.011 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean        se      L95%      U95%</span></span>
<span><span class="co">#&gt; shape -0.437065 0.0785317 -0.590984 -0.283146</span></span>
<span><span class="co">#&gt; rate   0.208811 0.0365708  0.148141  0.294328</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 470.201</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 476.797</span></span></code></pre>
<p><img src="Survival_functions_files/figure-html/gompertz_models-4.png" width="768"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fit for the Gompertz model, obtained using Flexsurvreg </span></span>
<span><span class="co">#&gt; (Maximum Likelihood Estimate). Running time: 0.010 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean        se      L95%      U95%</span></span>
<span><span class="co">#&gt; shape -0.316976 0.0538467 -0.422513 -0.211438</span></span>
<span><span class="co">#&gt; rate   0.199665 0.0382986  0.137098  0.290787</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitting summaries</span></span>
<span><span class="co">#&gt; Akaike Information Criterion (AIC)....: 364.319</span></span>
<span><span class="co">#&gt; Bayesian Information Criterion (BIC)..: 369.756</span></span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Wael Mohammed.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
